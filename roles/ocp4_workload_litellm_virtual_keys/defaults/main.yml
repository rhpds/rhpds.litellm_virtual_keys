---
# =============================================================================
# LiteLLM Virtual Keys Workload - Default Variables
# =============================================================================

# -----------------------------------------------------------------------------
# Required Variables (must be provided by caller)
# -----------------------------------------------------------------------------
# guid: "a1b2c3d4"  # Lab environment GUID

# -----------------------------------------------------------------------------
# LiteLLM API Connection Settings
# -----------------------------------------------------------------------------
# These should be overridden in inventory or vault
litellm_url: ""
litellm_master_key: ""

# -----------------------------------------------------------------------------
# Model and Duration Selection
# -----------------------------------------------------------------------------
# List of AI models accessible with this key
# User can select one or more models from AgnosticV dropdown
ocp4_workload_litellm_virtual_keys_models:
  - "openai/granite-3-2-8b-instruct"
  - "openai/mistral-7b-instruct"

# Key validity duration (selected from AgnosticV dropdown)
# Format: "3d", "7d", "10d", "30d"
# NOTE: If agnosticd_user_info.runtime is available, it will override this value
# This enables automatic CI lifecycle integration (keys expire with catalog items)
ocp4_workload_litellm_virtual_keys_duration: "30d"

# -----------------------------------------------------------------------------
# Key Naming Convention
# -----------------------------------------------------------------------------
# Format: virtkey-{GUID}
# This creates unique, identifiable keys for each lab environment
ocp4_workload_litellm_virtual_keys_alias_format: "virtkey-{{ guid }}"

# -----------------------------------------------------------------------------
# User Identification
# -----------------------------------------------------------------------------
# Uses email if provided, otherwise generates from GUID
ocp4_workload_litellm_virtual_keys_user_id_format: "{{ email | default(guid + '@lab.opentlc.com') }}"

# -----------------------------------------------------------------------------
# Metadata for Tracking
# -----------------------------------------------------------------------------
# Attached to each key for auditing and management
ocp4_workload_litellm_virtual_keys_metadata:
  created_by: "agnosticd"
  environment: "{{ env_type | default('sandbox') }}"

# -----------------------------------------------------------------------------
# API Settings
# -----------------------------------------------------------------------------
ocp4_workload_litellm_virtual_keys_api_timeout: 30
ocp4_workload_litellm_virtual_keys_verify_ssl: true
ocp4_workload_litellm_virtual_keys_retry_count: 3
ocp4_workload_litellm_virtual_keys_retry_delay: 5

# -----------------------------------------------------------------------------
# Budget Settings
# -----------------------------------------------------------------------------
# null = unlimited budget (default for RHDP labs)
ocp4_workload_litellm_virtual_keys_max_budget: null

# -----------------------------------------------------------------------------
# Output Settings
# -----------------------------------------------------------------------------
ocp4_workload_litellm_virtual_keys_store_key_in_facts: true
ocp4_workload_litellm_virtual_keys_display_key: true

# -----------------------------------------------------------------------------
# User Info Settings (AgnosticD integration)
# -----------------------------------------------------------------------------
# These settings require agnosticd.core collection to be installed
# Disable for standalone testing without AgnosticD

# Enable user.info messages (shown to user in email/UI)
ocp4_workload_litellm_virtual_keys_enable_user_info_messages: true

# Enable user.info data (stored for automation/API access)
ocp4_workload_litellm_virtual_keys_enable_user_info_data: true

# Custom user info messages (optional)
# These will be shown to the user along with the generated key info
ocp4_workload_litellm_virtual_keys_user_info_messages: []

# -----------------------------------------------------------------------------
# Delete Method
# -----------------------------------------------------------------------------
# Options: "by_alias" (default) or "by_key_id"
ocp4_workload_litellm_virtual_keys_delete_method: "by_alias"

# Enable direct database deletion (workaround for LiteLLM delete API bug)
# Requires access to postgres pod in the same namespace
ocp4_workload_litellm_virtual_keys_force_db_delete: false

# Postgres pod name (only used if force_db_delete is true)
ocp4_workload_litellm_virtual_keys_postgres_pod: "postgres-0"

# Postgres database name
ocp4_workload_litellm_virtual_keys_postgres_db: "litellm"

# Namespace where LiteLLM and Postgres are deployed
ocp4_workload_litellm_virtual_keys_namespace: "rhpds"

# -----------------------------------------------------------------------------
# Multi-User Support
# -----------------------------------------------------------------------------
# Enable multi-user mode to create one virtual key per user
# When enabled, creates keys for each user (user1, user2, user3, etc.)
ocp4_workload_litellm_virtual_keys_multi_user: false

# Auto-detect user count from common variable (set at catalog level)
# Falls back to num_users catalog parameter, then defaults to 1
ocp4_workload_litellm_virtual_keys_user_count: "{{ ocp4_workload_user_count | default(num_users | default(1)) | int }}"

# Auto-detect user base from common variable (htpasswd/RHSSO/RHBK use this)
# Results in: user1, user2, user3, etc.
ocp4_workload_litellm_virtual_keys_user_base: "{{ ocp4_workload_user_base | default('user') }}"

# Email domain for multi-user keys
# Results in: user1@lab.opentlc.com, user2@lab.opentlc.com, etc.
ocp4_workload_litellm_virtual_keys_user_email_domain: "lab.opentlc.com"
